---
layout: single
title: "MySQL 쿼리"
date: 2025-01-27
categories:
  - MySQL
tags:
  - SQL
  - MySQL
  - Database
  - 쿼리
toc: true
toc_sticky: true
---

데이터베이스를 다루다 보면 SQL 쿼리 작성이 필수가 됩니다. 특히 MySQL을 사용할 때 자주 쓰이는 구문과 함수들을 정리해두면 실무에서 큰 도움이 됩니다.

이번 글에서는 **SELECT 문의 기본 구조**부터 **문자열, 날짜, 숫자, 조건식 함수**까지 MySQL에서 자주 사용하는 SQL 쿼리들을 예제와 함께 정리해보겠습니다.

> **💡 참고사항**  
> 이 글의 모든 예제는 **MySQL 8.0** 기준으로 작성되었습니다. PostgreSQL, SQL Server, Oracle 등 다른 RDBMS에서는 함수명이나 문법이 다를 수 있으니 참고해주세요.

## SELECT 문의 기본 구조

SQL에서 데이터를 조회할 때 사용하는 SELECT 문의 기본 구조는 다음과 같습니다:

```sql
SELECT 컬럼1, 컬럼2, ...
FROM 테이블명
WHERE 조건1 AND 조건2 OR (조건3 AND 조건4)
GROUP BY 그룹화할_컬럼1, 그룹화할_컬럼2
HAVING 그룹_조건
ORDER BY 정렬할_컬럼 ASC|DESC, 정렬할_컬럼2 ASC|DESC
LIMIT 숫자;
```

각 절의 역할을 간단히 정리하면:

- **SELECT**: 조회할 컬럼 지정 (문자열 지정도 가능)
- **FROM**: 대상 테이블 지정  
- **WHERE**: 행 단위 조건 필터링 (괄호로 논리 연산 우선순위 조절 가능)
- **GROUP BY**: 특정 컬럼 기준으로 데이터 그룹화
- **HAVING**: 그룹화된 데이터에 조건 적용
- **ORDER BY**: 결과 정렬 (ASC: 오름차순, DESC: 내림차순)
- **LIMIT**: 결과 개수 제한

### 예제

```sql
-- 점수가 80점 이상인 A반, B반 학생들을 점수 내림차순으로 상위 10명 조회
SELECT name, class, score
FROM students
WHERE score >= 80 AND (class = 'A' OR class = 'B')
ORDER BY score DESC
LIMIT 10;
```

## 문자열 처리 함수

### CONCAT - 문자열 연결

여러 문자열을 하나로 합칠 때 사용합니다.

```sql
-- 기본 사용법
SELECT CONCAT(first_name, ' ', last_name) AS full_name
FROM employees;

-- 결과: 'John Doe', 'Jane Smith' 등
```

### SUBSTRING - 부분 문자열 추출

문자열에서 특정 부분만 추출할 때 사용합니다.

```sql
SUBSTRING(문자열, 시작위치(1부터), 길이)

-- 예제
SELECT SUBSTRING('Hello World', 1, 5) AS result;
-- 결과: 'Hello'

SELECT SUBSTRING('Hello World', 7, 5) AS result;
-- 결과: 'World'
```

### LOWER, UPPER - 대소문자 변환

```sql
SELECT 
    LOWER('MySQL') AS lowercase,  -- 'mysql'
    UPPER('database') AS uppercase -- 'DATABASE'
FROM dual;
```

### TRIM, LTRIM, RTRIM - 공백 제거

```sql
SELECT 
    TRIM('  MySQL  ') AS trimmed,      -- 'MySQL' (양쪽 공백 제거)
    LTRIM('  MySQL  ') AS left_trim,   -- 'MySQL  ' (왼쪽 공백 제거)
    RTRIM('  MySQL  ') AS right_trim   -- '  MySQL' (오른쪽 공백 제거)
FROM dual;
```

### REPLACE - 문자열 치환

```sql
SELECT REPLACE('Hello World', 'World', 'MySQL') AS result;
-- 결과: 'Hello MySQL'
```

### REGEXP_REPLACE - 정규식 기반 치환

```sql
-- 숫자만 제거하기
SELECT REGEXP_REPLACE('abc123def456', '[0-9]', '') AS result;
-- 결과: 'abcdef'
```

## 날짜 처리 함수

### 날짜 포맷 코드표

MySQL에서 날짜를 포맷팅할 때 사용하는 주요 코드들입니다:

| 코드 | 설명 | 예시 |
|------|------|------|
| `%Y` | 연도 (4자리) | `2025` |
| `%y` | 연도 (2자리) | `25` |
| `%m` | 월 (2자리, 01-12) | `04` |
| `%c` | 월 (1-12) | `4` |
| `%d` | 일 (2자리, 01-31) | `08` |
| `%e` | 일 (1-31) | `8` |
| `%H` | 시 (24시간, 00-23) | `15` |
| `%h`, `%I` | 시 (12시간, 01-12) | `03` |
| `%i` | 분 (00-59) | `45` |
| `%s`, `%S` | 초 (00-59) | `20` |
| `%p` | AM/PM | `PM` |
| `%W` | 요일 이름 | `Wednesday` |
| `%a` | 요일 약어 | `Wed` |
| `%M` | 월 이름 | `April` |
| `%b` | 월 약어 | `Apr` |

### NOW(), CURRENT_DATE - 현재 날짜/시간

```sql
SELECT 
    NOW() AS current_datetime,           -- 2025-01-27 14:30:25
    CURRENT_DATE AS current_date,        -- 2025-01-27
    CURDATE() AS current_date_short      -- 2025-01-27
FROM dual;
```

### DATE_FORMAT - 날짜 포맷 변경

```sql
SELECT DATE_FORMAT(NOW(), '%Y년 %m월 %d일 %H시 %i분') AS formatted_date;
-- 결과: '2025년 01월 27일 14시 30분'

SELECT DATE_FORMAT('2025-01-27', '%Y/%m/%d (%a)') AS formatted;
-- 결과: '2025/01/27 (Mon)'
```

### STR_TO_DATE - 문자열을 날짜로 변환

```sql
SELECT STR_TO_DATE('2025-01-27 14:30', '%Y-%m-%d %H:%i') AS converted_date;
-- 결과: 2025-01-27 14:30:00
```

### DATEDIFF - 날짜 차이 계산

```sql
SELECT DATEDIFF('2025-01-27', '2025-01-20') AS day_diff;
-- 결과: 7 (일 단위 차이)
```

### YEAR, MONTH, DAY - 날짜 구성요소 추출

```sql
SELECT 
    YEAR('2025-01-27') AS year_part,     -- 2025
    MONTH('2025-01-27') AS month_part,   -- 1
    DAY('2025-01-27') AS day_part        -- 27
FROM dual;
```

## 숫자 처리 함수

### ROUND - 반올림

```sql
SELECT 
    ROUND(123.456, 2) AS rounded_2,    -- 123.46
    ROUND(123.456, 1) AS rounded_1,    -- 123.5
    ROUND(123.456, 0) AS rounded_0     -- 123
FROM dual;
```

### FLOOR, CEIL - 내림/올림

```sql
SELECT 
    FLOOR(123.789) AS floor_result,    -- 123 (내림)
    CEIL(123.123) AS ceil_result       -- 124 (올림)
FROM dual;
```

### ABS - 절댓값

```sql
SELECT ABS(-123.45) AS absolute_value;  -- 123.45
```

### MOD - 나머지

```sql
SELECT MOD(17, 5) AS remainder;  -- 2 (17을 5로 나눈 나머지)
```

## 조건 처리 함수

### IF - 단순 조건 분기

```sql
SELECT 
    name,
    score,
    IF(score >= 60, '합격', '불합격') AS result
FROM students;
```

### CASE - 복합 조건 분기

```sql
SELECT 
    name,
    age,
    CASE 
        WHEN age >= 20 THEN '성인'
        WHEN age >= 13 THEN '청소년'
        WHEN age >= 7 THEN '어린이'
        ELSE '유아'
    END AS age_group
FROM users;
```

### IFNULL - NULL 값 처리

```sql
SELECT 
    name,
    IFNULL(phone, '연락처 없음') AS contact
FROM customers;
```

### COALESCE - 여러 값 중 NULL이 아닌 첫 번째 값

```sql
SELECT 
    name,
    COALESCE(mobile, office_phone, home_phone, '연락처 없음') AS primary_contact
FROM customers;
-- mobile이 NULL이 아니면 mobile을, NULL이면 office_phone을, 
-- 그것도 NULL이면 home_phone을, 모두 NULL이면 '연락처 없음'을 반환
```

## 마무리

이번 글에서 정리한 MySQL 함수들은 실무에서 가장 자주 사용되는 것들입니다. 특히 문자열 처리, 날짜 계산, 조건부 로직은 거의 모든 프로젝트에서 필요한 기능들이죠.

이러한 함수들을 조합해서 사용하면 더 복잡한 데이터 처리도 가능합니다. 예를 들어:

```sql
-- 실무 활용 예제: 고객 정보를 보기 좋게 정리
SELECT 
    CONCAT(UPPER(SUBSTRING(name, 1, 1)), LOWER(SUBSTRING(name, 2))) AS formatted_name,
    DATE_FORMAT(birth_date, '%Y년 %m월 %d일') AS birth_formatted,
    CASE 
        WHEN DATEDIFF(CURDATE(), birth_date) / 365 >= 65 THEN '시니어'
        WHEN DATEDIFF(CURDATE(), birth_date) / 365 >= 20 THEN '일반'
        ELSE '청소년'
    END AS customer_type,
    COALESCE(mobile, phone, '연락처 없음') AS contact
FROM customers
WHERE created_at >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)
ORDER BY created_at DESC;
```
